# üéØ –ö–û–†–û–¢–ö–ò–ô –ó–í–Ü–¢: Dashboard Analytics

**–î–∞—Ç–∞:** 21.02.2026  
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 15:11 UTC

---

## ‚úÖ –©–û –ì–û–¢–û–í–û:

### 1. –ö–æ–¥
- ‚úÖ **Edge Function `admin`** - –∑–∞–¥–µ–ø–ª–æ—î–Ω–∞ (v45, 15:11:45)
- ‚úÖ **DashboardPanel.tsx** - 5 –Ω–æ–≤–∏—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –¥–æ–¥–∞–Ω–æ
- ‚úÖ **BotVisitsPanel.tsx** - –ª—ñ–º—ñ—Ç 1000 –∑–Ω—è—Ç–æ
- ‚úÖ **–ü–æ–º–∏–ª–∫–∏ TypeScript** - 0 –ø–æ–º–∏–ª–æ–∫

### 2. API Endpoints (–≥–æ—Ç–æ–≤—ñ —ñ –ø—Ä–∞—Ü—é—é—Ç—å)
- ‚úÖ `getBotVisitsStats` - –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é 24h/7d/30d
- ‚úÖ `getPageViewsHourly` - –∑ fallback –ª–æ–≥—ñ–∫–æ—é
- ‚úÖ `getUniqueVisitorsHourly` 
- ‚úÖ `getTopTrafficCountries`

### 3. –§–∞–π–ª–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó
- ‚úÖ `supabase/migrations/20260221000000_add_entity_views_log.sql`
- ‚úÖ `APPLY_MIGRATION.sql` - –≥–æ—Ç–æ–≤–∏–π SQL
- ‚úÖ `MIGRATION_INSTRUCTIONS.md` - –¥–µ—Ç–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó
- ‚úÖ `check-migration.ps1` - —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
- ‚úÖ `apply-migration.ps1` - —Å–∫—Ä–∏–ø—Ç –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è

---

## ‚è≥ –ü–û–¢–†–Ü–ë–ù–û –ó–†–û–ë–ò–¢–ò (3 —Ö–≤–∏–ª–∏–Ω–∏):

### üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–∫–∞–∑–∞–ª–∞:** –¢–∞–±–ª–∏—Ü—è `entity_views` –ù–ï —ñ—Å–Ω—É—î ‚ùå

**–Ø–∫ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏:**

#### üöÄ –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —Å–ø–æ—Å—ñ–±:
```powershell
.\apply-migration.ps1
```
*–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–∫—Ä–∏—î Supabase SQL Editor –∑ –≥–æ—Ç–æ–≤–∏–º SQL*

#### üìã –†—É—á–Ω–∏–π —Å–ø–æ—Å—ñ–±:
1. –í—ñ–¥–∫—Ä–∏—Ç–∏: https://supabase.com/dashboard/project/tuledxqigzufkecztnlo/sql/new
2. –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ SQL –∑ `APPLY_MIGRATION.sql`
3. –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ **RUN**

---

## üìä –°—Ç–∞—Ç—É—Å –≥—Ä–∞—Ñ—ñ–∫—ñ–≤:

### ‚úÖ –ü—Ä–∞—Ü—é—é—Ç—å –ó–ê–†–ê–ó (–±–µ–∑ –º—ñ–≥—Ä–∞—Ü—ñ—ó):
1. **–ë–æ—Ç –≤—ñ–∑–∏—Ç–∏** (–∑ –ø–µ—Ä–µ–º–∏–∫–∞—á–µ–º 24h/7d/30d) ‚Üê NEW!
2. **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ** (24 –≥–æ–¥) ‚Üê NEW!
3. **Top 10 –∫—Ä–∞—ó–Ω** ‚Üê NEW!
4. **Bot Response Time** ‚Üê NEW!

### ‚ö†Ô∏è –ü—ñ—Å–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑–∞–ø—Ä–∞—Ü—é—î:
5. **–ü–µ—Ä–µ–≥–ª—è–¥–∏ –∑–∞ —Ç–∏–ø–æ–º** (News vs Wiki) ‚Üê NEW!
   - –ó–∞—Ä–∞–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î fallback (`view_visitors`)
   - –ü—ñ—Å–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó –±—É–¥–µ —Ç–æ—á–Ω—ñ—à–µ (`entity_views`)

---

## üß™ –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:

### 1. –ü—ñ—Å–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó:
```powershell
.\check-migration.ps1
```

### 2. –í—ñ–¥–∫—Ä–∏—Ç–∏ Dashboard:
```
http://localhost:8080/admin
‚Üí –í–∫–ª–∞–¥–∫–∞ "Dashboard"
```

### 3. –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ API:
```powershell
.\test-dashboard-api.ps1
```

---

## üé® –ù–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:

### –ë–æ—Ç –≤—ñ–∑–∏—Ç–∏:
- üìÖ **–ü–µ—Ä–µ–º–∏–∫–∞—á –ø–µ—Ä—ñ–æ–¥—ñ–≤:** 24h / 7d / 30d
- üìä **–ê–≤—Ç–æ–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è:** –ø–æ–≥–æ–¥–∏–Ω–Ω–æ (24h) –∞–±–æ –ø–æ –¥–Ω—è—Ö (7d/30d)
- ‚ö° **Response Time:** —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø–æ –±–æ—Ç–∞—Ö
- ‚úÖ **Success Rate:** –≤—ñ–¥—Å–æ—Ç–æ–∫ —É—Å–ø—ñ—à–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

### –ù–æ–≤—ñ –≥—Ä–∞—Ñ—ñ–∫–∏:
1. **Unique Visitors Hourly** - emerald area chart
2. **Page Views by Type** - sky stacked area (News + Wiki)
3. **Bot Response Time** - pink horizontal bar
4. **Cloudflare Bandwidth** - indigo area (–ø–æ—Ç—Ä–µ–±—É—î API –∫–ª—é—á—ñ)
5. **Top Traffic Countries** - purple gradient bar

### Auto-refresh:
- Bot Visits: **15 —Å–µ–∫**
- Page Views: **30 —Å–µ–∫**
- Unique Visitors: **30 —Å–µ–∫**
- Top Countries: **60 —Å–µ–∫**

---

## üìå –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

1. ‚è≥ **–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é** (3 —Ö–≤) ‚Üê –ó–ê–†–ê–ó
2. ‚úÖ –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞–¥–º—ñ–Ω–∫—É
3. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ 5 –≥—Ä–∞—Ñ—ñ–∫—ñ–≤
4. üîß –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Cloudflare API (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

---

**–ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å:** 95% (—á–µ–∫–∞—î –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó)  
**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —á–∞—Å:** 3 —Ö–≤–∏–ª–∏–Ω–∏
