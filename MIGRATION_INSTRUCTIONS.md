# üìä –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –ø–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—é –º—ñ–≥—Ä–∞—Ü—ñ—ó Dashboard Analytics

## ‚úÖ –©–æ –≤–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ:

1. ‚úÖ Edge Function `admin` –æ–Ω–æ–≤–ª–µ–Ω–∞ —Ç–∞ –∑–∞–¥–µ–ø–ª–æ—î–Ω–∞
2. ‚úÖ –î–æ–¥–∞–Ω–æ –Ω–æ–≤—ñ API endpoints:
   - `getBotVisitsStats` (–∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é 24h/7d/30d)
   - `getPageViewsHourly`
   - `getUniqueVisitorsHourly`
   - `getTopTrafficCountries`
3. ‚úÖ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≥–æ—Ç–æ–≤—ñ –≤ DashboardPanel

## ‚è≥ –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –ë–î:

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (–†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–û)

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ SQL Editor: 
   https://supabase.com/dashboard/project/tuledxqigzufkecztnlo/sql/new

2. –°–∫–æ–ø—ñ—é–π—Ç–µ SQL –∑ —Ñ–∞–π–ª—É `APPLY_MIGRATION.sql` (–≤–∂–µ –≤ –±—É—Ñ–µ—Ä—ñ –æ–±–º—ñ–Ω—É)

3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **RUN**

4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ —Ç–∞–±–ª–∏—Ü—è —Å—Ç–≤–æ—Ä–µ–Ω–∞:
   ```sql
   SELECT * FROM public.entity_views LIMIT 1;
   ```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ CLI (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

```bash
# –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –Ω–æ–≤—É –º—ñ–≥—Ä–∞—Ü—ñ—é
npx supabase db push --include-all
```

## üéØ –Ø–∫ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º—É—Ç—å –≥—Ä–∞—Ñ—ñ–∫–∏:

### –ì—Ä–∞—Ñ—ñ–∫–∏ –∑ fallback (–ø—Ä–∞—Ü—é—é—Ç—å –∑–∞—Ä–∞–∑):
- ‚úÖ **–ë–æ—Ç –≤—ñ–∑–∏—Ç–∏** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `bot_visits` (–≤–∂–µ –ø—Ä–∞—Ü—é—î)
- ‚úÖ **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `view_visitors` (–≤–∂–µ –ø—Ä–∞—Ü—é—î)
- ‚úÖ **Top 10 –∫—Ä–∞—ó–Ω** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `bot_visits.ip_country` (–≤–∂–µ –ø—Ä–∞—Ü—é—î)
- ‚úÖ **Bot Response Time** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `bot_visits.response_time_ms` (–≤–∂–µ –ø—Ä–∞—Ü—é—î)

### –ì—Ä–∞—Ñ—ñ–∫–∏ —â–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –º—ñ–≥—Ä–∞—Ü—ñ—ó:
- ‚è≥ **–ü–µ—Ä–µ–≥–ª—è–¥–∏ –∑–∞ —Ç–∏–ø–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç—É** - –ø–æ—Ç—Ä–µ–±—É—î `entity_views`
- ‚è≥ **Cloudflare Bandwidth** - –ø–æ—Ç—Ä–µ–±—É—î Cloudflare API –∫–ª—é—á—ñ

## üìù –ü—ñ—Å–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó:

1. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∞–¥–º—ñ–Ω–∫–∏
2. –£—Å—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ –ø–æ—á–Ω—É—Ç—å –Ω–∞–∫–æ–ø–∏—á—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ
3. –ß–µ—Ä–µ–∑ ~1 –≥–æ–¥–∏–Ω—É –∑'—è–≤–ª—è—Ç—å—Å—è –ø–µ—Ä—à—ñ –¥–∞–Ω—ñ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫–∞—Ö

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Cloudflare (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):

–©–æ–± –ø—Ä–∞—Ü—é–≤–∞–≤ –≥—Ä–∞—Ñ—ñ–∫ "Cloudflare Bandwidth", –¥–æ–¥–∞–π—Ç–µ –≤ Edge Function secrets:

```bash
npx supabase secrets set CLOUDFLARE_ACCOUNT_ID=your_account_id
npx supabase secrets set CLOUDFLARE_API_TOKEN=your_token
npx supabase secrets set CLOUDFLARE_ZONE_ID=your_zone_id
```

## üé® –ù–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ Dashboard:

### –ë–æ—Ç –≤—ñ–∑–∏—Ç–∏:
- üìÖ –ü–µ—Ä–µ–º–∏–∫–∞—á –ø–µ—Ä—ñ–æ–¥—ñ–≤: **24 –≥–æ–¥ / 7 –¥–Ω—ñ–≤ / 30 –¥–Ω—ñ–≤**
- üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è: –ø–æ–≥–æ–¥–∏–Ω–Ω–æ / –ø–æ –¥–Ω—è—Ö
- üìà 4 –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –±–æ—Ç—ñ–≤: Google, Bing, AI, –Ü–Ω—à—ñ

### –ù–æ–≤—ñ –≥—Ä–∞—Ñ—ñ–∫–∏:
1. **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ (24 –≥–æ–¥)** - –ø–æ–≥–æ–¥–∏–Ω–Ω–∞ –¥–∏–Ω–∞–º—ñ–∫–∞
2. **–ü–µ—Ä–µ–≥–ª—è–¥–∏ News vs Wiki** - stacked area chart
3. **Bot Response Time** - —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –ø–æ —Ç–∏–ø–∞—Ö –±–æ—Ç—ñ–≤
4. **Cloudflare Bandwidth** - timeseries —Ç—Ä–∞—Ñ—ñ–∫—É
5. **Top 10 –∫—Ä–∞—ó–Ω** - –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏–π bar chart

---

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ:** 21.02.2026
**–ü—Ä–æ–µ–∫—Ç:** chrono-narrative-engine
